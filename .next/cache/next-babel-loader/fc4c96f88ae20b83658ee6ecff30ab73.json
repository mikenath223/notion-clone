{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/project/notion-clone/components/tagSelectorMenu/index.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect } from \"react\";\nimport matchSorter from \"match-sorter\";\nimport styles from \"./styles.module.scss\";\nvar MENU_HEIGHT = 150;\nvar allowedTags = [{\n  id: \"page-title\",\n  tag: \"h1\",\n  label: \"Page Title\"\n}, {\n  id: \"heading\",\n  tag: \"h2\",\n  label: \"Heading\"\n}, {\n  id: \"subheading\",\n  tag: \"h3\",\n  label: \"Subheading\"\n}, {\n  id: \"paragraph\",\n  tag: \"p\",\n  label: \"Paragraph\"\n}, {\n  id: \"image\",\n  tag: \"img\",\n  label: \"Image\"\n}];\n\nvar TagSelectorMenu = function TagSelectorMenu(_ref) {\n  _s();\n\n  var position = _ref.position,\n      closeMenu = _ref.closeMenu,\n      handleSelection = _ref.handleSelection;\n\n  var _useState = useState(allowedTags),\n      tagList = _useState[0],\n      setTagList = _useState[1];\n\n  var _useState2 = useState(0),\n      selectedTag = _useState2[0],\n      setSelectedTag = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      command = _useState3[0],\n      setCommand = _useState3[1]; // If the tag selector menu is display outside the top viewport,\n  // we display it below the block\n\n\n  var isMenuOutsideOfTopViewport = position.y - MENU_HEIGHT < 0;\n  var y = !isMenuOutsideOfTopViewport ? position.y - MENU_HEIGHT : position.y + MENU_HEIGHT / 3;\n  var x = position.x; // Filter tagList based on given command\n\n  useEffect(function () {\n    setTagList(matchSorter(allowedTags, command, {\n      keys: [\"tag\"]\n    }));\n  }, [command]); // Attach listener to allow tag selection via keyboard\n\n  useEffect(function () {\n    var handleKeyDown = function handleKeyDown(e) {\n      if (e.key === \"Enter\") {\n        e.preventDefault();\n        handleSelection(tagList[selectedTag].tag);\n      } else if (e.key === \"Tab\" || e.key === \"ArrowDown\") {\n        e.preventDefault();\n        var newSelectedTag = selectedTag === tagList.length - 1 ? 0 : selectedTag + 1;\n        setSelectedTag(newSelectedTag);\n      } else if (e.key === \"ArrowUp\") {\n        e.preventDefault();\n\n        var _newSelectedTag = selectedTag === 0 ? tagList.length - 1 : selectedTag - 1;\n\n        setSelectedTag(_newSelectedTag);\n      } else if (e.key === \"Backspace\") {\n        if (command) {\n          setCommand(command.slice(0, -1));\n        } else {\n          closeMenu();\n        }\n      } else {\n        setCommand(command + e.key);\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return function () {\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [tagList, selectedTag]);\n  return __jsx(\"div\", {\n    className: styles.menuWrapper,\n    style: {\n      top: y,\n      left: x,\n      justifyContent: !isMenuOutsideOfTopViewport ? \"flex-end\" : \"flex-start\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: styles.menu,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }, tagList.map(function (tag, key) {\n    return __jsx(\"div\", {\n      key: key,\n      \"data-tag\": tag.tag,\n      className: tagList.indexOf(tag) === selectedTag ? [styles.item, styles.selectedTag].join(\" \") : styles.item,\n      role: \"button\",\n      tabIndex: \"0\",\n      onClick: function onClick() {\n        return handleSelection(tag.tag);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, tag.label);\n  })));\n};\n\n_s(TagSelectorMenu, \"8NWnbhNStuuW/Mz1E/7RONk99II=\");\n\n_c = TagSelectorMenu;\nexport default TagSelectorMenu;\n\nvar _c;\n\n$RefreshReg$(_c, \"TagSelectorMenu\");","map":{"version":3,"sources":["/project/notion-clone/components/tagSelectorMenu/index.js"],"names":["useState","useEffect","matchSorter","styles","MENU_HEIGHT","allowedTags","id","tag","label","TagSelectorMenu","position","closeMenu","handleSelection","tagList","setTagList","selectedTag","setSelectedTag","command","setCommand","isMenuOutsideOfTopViewport","y","x","keys","handleKeyDown","e","key","preventDefault","newSelectedTag","length","slice","document","addEventListener","removeEventListener","menuWrapper","top","left","justifyContent","menu","map","indexOf","item","join"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport matchSorter from \"match-sorter\";\n\nimport styles from \"./styles.module.scss\";\n\nconst MENU_HEIGHT = 150;\nconst allowedTags = [\n  {\n    id: \"page-title\",\n    tag: \"h1\",\n    label: \"Page Title\",\n  },\n  {\n    id: \"heading\",\n    tag: \"h2\",\n    label: \"Heading\",\n  },\n  {\n    id: \"subheading\",\n    tag: \"h3\",\n    label: \"Subheading\",\n  },\n  {\n    id: \"paragraph\",\n    tag: \"p\",\n    label: \"Paragraph\",\n  },\n  {\n    id: \"image\",\n    tag: \"img\",\n    label: \"Image\",\n  },\n];\n\nconst TagSelectorMenu = ({ position, closeMenu, handleSelection }) => {\n  const [tagList, setTagList] = useState(allowedTags);\n  const [selectedTag, setSelectedTag] = useState(0);\n  const [command, setCommand] = useState(\"\");\n\n  // If the tag selector menu is display outside the top viewport,\n  // we display it below the block\n  const isMenuOutsideOfTopViewport = position.y - MENU_HEIGHT < 0;\n  const y = !isMenuOutsideOfTopViewport\n    ? position.y - MENU_HEIGHT\n    : position.y + MENU_HEIGHT / 3;\n  const x = position.x;\n\n  // Filter tagList based on given command\n  useEffect(() => {\n    setTagList(matchSorter(allowedTags, command, { keys: [\"tag\"] }));\n  }, [command]);\n\n  // Attach listener to allow tag selection via keyboard\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (e.key === \"Enter\") {\n        e.preventDefault();\n        handleSelection(tagList[selectedTag].tag);\n      } else if (e.key === \"Tab\" || e.key === \"ArrowDown\") {\n        e.preventDefault();\n        const newSelectedTag =\n          selectedTag === tagList.length - 1 ? 0 : selectedTag + 1;\n        setSelectedTag(newSelectedTag);\n      } else if (e.key === \"ArrowUp\") {\n        e.preventDefault();\n        const newSelectedTag =\n          selectedTag === 0 ? tagList.length - 1 : selectedTag - 1;\n        setSelectedTag(newSelectedTag);\n      } else if (e.key === \"Backspace\") {\n        if (command) {\n          setCommand(command.slice(0, -1));\n        } else {\n          closeMenu();\n        }\n      } else {\n        setCommand(command + e.key);\n      }\n    };\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => {\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [tagList, selectedTag]);\n\n  return (\n    <div\n      className={styles.menuWrapper}\n      style={{\n        top: y,\n        left: x,\n        justifyContent: !isMenuOutsideOfTopViewport ? \"flex-end\" : \"flex-start\",\n      }}\n    >\n      <div className={styles.menu}>\n        {tagList.map((tag, key) => {\n          return (\n            <div\n              key={key}\n              data-tag={tag.tag}\n              className={\n                tagList.indexOf(tag) === selectedTag\n                  ? [styles.item, styles.selectedTag].join(\" \")\n                  : styles.item\n              }\n              role=\"button\"\n              tabIndex=\"0\"\n              onClick={() => handleSelection(tag.tag)}\n            >\n              {tag.label}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default TagSelectorMenu;\n"]},"metadata":{},"sourceType":"module"}